(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-51df0518"],{5451:function(e,t,n){},a05d:function(e,t,n){"use strict";var a=n("5451"),i=n.n(a);i.a},e656:function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"demo"},[n("div",{staticClass:"rtcBox"},[n("ul",e._l(e.handleList,function(t){return n("li",{key:t.type},["color"===t.type?n("el-color-picker",{attrs:{"show-alpha":"",disabled:e.allowHangup},on:{change:e.colorChange},model:{value:e.color,callback:function(t){e.color=t},expression:"color"}}):e._e(),["color","lineWidth","polygon"].includes(t.type)?e._e():n("button",{class:{active:e.currHandle===t.type},attrs:{disabled:"cancel"===t.type?e.allowHangup||e.allowCancel:"go"===t.type?e.allowHangup||e.allowGo:e.allowHangup},on:{click:function(n){e.handleClick(t)}}},[e._v("\n                    "+e._s(t.name)+"\n                ")]),"polygon"===t.type?n("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"}},[n("el-input-number",{attrs:{"controls-position":"right",min:3,max:10},on:{change:e.sidesChange},model:{value:e.sides,callback:function(t){e.sides=t},expression:"sides"}}),n("button",{class:{active:e.currHandle===t.type},attrs:{slot:"reference",disabled:e.allowHangup},on:{click:function(n){e.handleClick(t)}},slot:"reference"},[e._v(e._s(t.name))])],1):e._e(),"lineWidth"===t.type?n("el-popover",{attrs:{placement:"top",width:"400",trigger:"click"}},[n("el-slider",{attrs:{max:20},on:{change:e.lineWidthChange},model:{value:e.lineWidth,callback:function(t){e.lineWidth=t},expression:"lineWidth"}}),n("button",{attrs:{slot:"reference",disabled:e.allowHangup},slot:"reference"},[e._v(e._s(t.name)+" "),n("i",[e._v(e._s(e.lineWidth+"px"))])])],1):e._e()],1)})),n("div",[n("canvas",{ref:"canvas",attrs:{width:"400",height:"300"}}),n("h5",[e._v("白板操作")])]),n("div",[n("video",{attrs:{src:"",id:"rtcB",playsinline:"",autoplay:""}}),n("h5",[e._v("演示画面")]),n("button",{attrs:{disabled:e.allowCall},on:{click:e.call}},[e._v("call")]),n("button",{attrs:{disabled:e.allowHangup},on:{click:e.hangup}},[e._v("hangup")])])])])},i=[],r=(n("96cf"),n("3040")),c=(n("6762"),n("2fdb"),n("ebd66")),o={name:"whiteboard",data:function(){return{peerA:null,peerB:null,offerOption:{offerToReceiveAudio:1,offerToReceiveVideo:1},allowCall:!0,allowHangup:!0,handleList:[{name:"圆",type:"arc"},{name:"线条",type:"line"},{name:"矩形",type:"rect"},{name:"多边形",type:"polygon"},{name:"橡皮擦",type:"eraser"},{name:"撤回",type:"cancel"},{name:"前进",type:"go"},{name:"清屏",type:"clear"},{name:"线宽",type:"lineWidth"},{name:"颜色",type:"color"}],color:"rgba(19, 206, 102, 1)",currHandle:"line",lineWidth:5,palette:null,allowCancel:!0,allowGo:!0,sides:3}},methods:{initPalette:function(){this.palette=new c["a"](this.$refs["canvas"],{drawColor:this.color,drawType:this.currHandle,lineWidth:this.lineWidth,allowCallback:this.allowCallback})},allowCallback:function(e,t){this.allowCancel=!e,this.allowGo=!t},sidesChange:function(){this.palette.changeWay({sides:this.sides})},colorChange:function(){this.palette.changeWay({color:this.color})},lineWidthChange:function(){this.palette.changeWay({lineWidth:this.lineWidth})},handleClick:function(e){["cancel","go","clear"].includes(e.type)?this.palette[e.type]():(this.palette.changeWay({type:e.type}),["color","lineWidth"].includes(e.type)||(this.currHandle=e.type))},start:function(){this.state="2",this.newRecognition.start()},stop:function(){this.state="1",this.newRecognition.stop()},call:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.peerA&&this.peerB||this.initPeer(),e.prev=1,e.next=4,this.peerB.createOffer(this.offerOption);case 4:return t=e.sent,e.next=7,this.onCreateOffer(t);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](1),console.log("createOffer: ",e.t0);case 12:this.allowCall=!0,this.allowHangup=!1;case 14:case"end":return e.stop()}},e,this,[[1,9]])}));return function(){return e.apply(this,arguments)}}(),hangup:function(){this.peerA.close(),this.peerB.close(),this.peerA=null,this.peerB=null,this.allowCall=!1,this.allowHangup=!0,this.palette.destroy(),this.palette=null},onCreateOffer:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.peerB.setLocalDescription(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.log("Offer-setLocalDescription: ",e.t0);case 8:return e.prev=8,e.next=11,this.peerA.setRemoteDescription(t);case 11:e.next=16;break;case 13:e.prev=13,e.t1=e["catch"](8),console.log("Offer-setRemoteDescription: ",e.t1);case 16:return e.prev=16,e.next=19,this.peerA.createAnswer();case 19:return n=e.sent,e.next=22,this.onCreateAnswer(n);case 22:e.next=27;break;case 24:e.prev=24,e.t2=e["catch"](16),console.log("createAnswer: ",e.t2);case 27:case"end":return e.stop()}},e,this,[[0,5],[8,13],[16,24]])}));return function(t){return e.apply(this,arguments)}}(),onCreateAnswer:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.peerA.setLocalDescription(t);case 3:e.next=8;break;case 5:e.prev=5,e.t0=e["catch"](0),console.log("answer-setLocalDescription: ",e.t0);case 8:return e.prev=8,e.next=11,this.peerB.setRemoteDescription(t);case 11:e.next=16;break;case 13:e.prev=13,e.t1=e["catch"](8),console.log("answer-setRemoteDescription: ",e.t1);case 16:case"end":return e.stop()}},e,this,[[0,5],[8,13]])}));return function(t){return e.apply(this,arguments)}}(),initPeer:function(){var e=this,t=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;this.peerA=new t,this.peerA.addStream(this.localstream),this.peerA.onicecandidate=function(t){t.candidate&&e.peerB.addIceCandidate(t.candidate)},this.peerB=new t,this.peerB.onaddstream=function(t){var n=document.querySelector("#rtcB");n.srcObject=t.stream,e.initPalette()},this.peerB.onicecandidate=function(t){t.candidate&&e.peerA.addIceCandidate(t.candidate)},this.allowCall=!1},createMedia:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.localstream=this.$refs["canvas"].captureStream(),this.initPeer();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},mounted:function(){var e=this;this.$nextTick(function(){e.createMedia()})}},l=o,s=(n("a05d"),n("2877")),p=Object(s["a"])(l,a,i,!1,null,"f005d79c",null);p.options.__file="whiteboard.vue";t["default"]=p.exports}}]);